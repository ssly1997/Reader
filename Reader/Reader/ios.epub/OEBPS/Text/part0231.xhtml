<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>未知</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
  <h2 class="calibre9">27.3 在动画完成后执行特定的代码</h2>

  <p class="calibre1">　　编写iOS应用时，可能需要知道某个动画会在何时结束。这样就可以在动画结束时执行特定的代码，例如执行下一个动画，或者更新某个对象。怎样才能知道某个动画已经结束了？可以为completion:传入一个Block对象。</p>

  <p class="calibre1">　　修改BNRHypnosisViewController.m，在动画完成后向控制台输出一条日志信息。</p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">[UIView animateKeyframesWithDuration:1.0 delay:0.0 options:0 animations:^{</span></del></p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">[UIView addKeyframeWithRelativeStartTime:0 relativeDuration:0.8 animations:^{</span></del></p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">messageLabel.center = self.view.center;</span></del></p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">}];</span></del></p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">[UIView addKeyframeWithRelativeStartTime:0.8 relativeDuration:0.2 animations:^{</span></del></p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">int x = arc4random（） % width;</span></del></p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">int y = arc4random（） % height;</span></del></p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">messageLabel.center = CGPointMake（x, y）；</span></del></p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">}];</span></del></p>

  <p class="calibre1">　　<del class="calibre11"><span class="calibre10">} completion:NULL];</span></del></p>

  <p class="calibre1"><span class="calibre10">　　[UIView animateKeyframesWithDuration:1.0 delay:0.0 options:0 animations:^{</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　[UIView addKeyframeWithRelativeStartTime:0 relativeDuration:0.8 animations:^{</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　messageLabel.center = self.view.center;</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　}];</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　[UIView addKeyframeWithRelativeStartTime:0.8 relativeDuration:0.2 animations:^{</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　int x = arc4random（） % width;</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　int y = arc4random（） % height;</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　messageLabel.center = CGPointMake（x, y）；</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　}];</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　} completion:^（BOOL finished） {</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　NSLog（@“Animation finished”）；</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　}];</span><br class="calibre2"/></p>

  <p class="calibre1">　　UIInterpolatingMotionEffect *motionEffect =</p>

  <p class="calibre1">　　[[UIInterpolatingMotionEffect alloc] initWithKeyPath:@“center.x”</p>

  <p class="calibre1">　　type:UIInterpolatingMotionEffectTypeTiltAlongHorizontalAxis];</p>

  <p class="calibre1">　　构建并运行应用。在动画完成后，控制台就会输出动画执行完成的日志信息。</p>

  <p class="calibre1"><br class="calibre2"/></p>
<div class="calibre5">本书由「<a href="https://epubw.com" class="calibre6">ePUBw.COM</a>」整理，<a href="https://epubw.com" class="calibre6">ePUBw.COM</a> 提供最新最全的优质电子书下载！！！</div></body></html>
