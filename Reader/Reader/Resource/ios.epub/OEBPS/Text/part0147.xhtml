<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>未知</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="../../stylesheet.css" rel="stylesheet" type="text/css"/>
<link href="../../page_styles.css" rel="stylesheet" type="text/css"/>
</head>
  <body class="calibre">
  <h2 class="calibre9">16.2 创建约束</h2>

  <p class="calibre1">　　在代码中，约束是<span class="calibre10">NSLayoutConstraint</span>类的对象，添加约束时，需要先创建<span class="calibre10">NSLayoutConstraint</span>对象，再将其添加到视图对象中。在XIB文件中创建并添加约束只需要一步就可以完成，但是在代码中，创建和添加约束需要分为两个不同的步骤。</p>

  <p class="calibre1">　　<span class="calibre10">NSLayoutConstraint</span>提供了一个类方法，可以根据视觉化格式字符串创建约束：</p>

  <p class="calibre1">　　+ （NSArray *）<span class="calibre10">constraintsWithVisualFormat:</span>（NSString *）format</p>

  <p class="calibre1">　　<span class="calibre10">options:</span>（NSLayoutFormatOptions）opts</p>

  <p class="calibre1">　　<span class="calibre10">metrics:</span>（NSDictionary *）metrics</p>

  <p class="calibre1">　　<span class="calibre10">views:</span>（NSDictionary *）views</p>

  <p class="calibre1">　　该方法返回一个<span class="calibre10">NSLayoutConstraint</span>对象数组——视觉化格式字符串可能同时创建多个约束。其中，第一个参数是视觉化格式字符串，第二、三个参数可以忽略，通常可以分别传入0和nil。第四个参数是视图名称字典，字典中包含视觉化格式字符串中需要使用的视图对象名称。例如，在下列的视觉化格式字符串中，包含imageView、dateLabel和toolbar三个视图对象名称，请注意，它们仅仅是一个字符串形式的名称而已。</p>

  <p class="calibre1">　　@“H:|-[imageView]-|”</p>

  <p class="calibre1">　　@“V:[dateLabel]-[imageView]-[toolbar]”</p>

  <p class="calibre1">　　为了让自动布局系统知道这些名称所表示的具体视图对象，就需要通过视图名称字典将名称与视图对象关联起来。例如，字符串@“imageView”表示的是self.imageView。</p>

  <p class="calibre1">　　在BNRDetailViewController.m中修改<span class="calibre10">viewDidLoad</span>方法，创建视图名称字典：</p>

  <p class="calibre1">　　[self.view addSubview:iv];</p>

  <p class="calibre1">　　self.imageView = iv;</p>

  <p class="calibre1"><span class="calibre10">　　NSDictionary *nameMap = @{ @“imageView” : self.imageView,</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　@“dateLabel” : self.dateLabel,</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　@“toolbar” : self.toolbar };</span><br class="calibre2"/></p>

  <p class="calibre1">　　}</p>

  <p class="calibre1">　　根据Apple命名规范，应该使用属性的名称或实例变量的名称作为视图对象的键。视觉化格式字符串将使用字典中的键表示相应的视图对象。</p>

  <p class="calibre1">　　接下来为imageView添加水平和垂直两个方向上的约束，代码如下：</p>

  <p class="calibre1">　　- （void）viewDidLoad</p>

  <p class="calibre1">　　{</p>

  <p class="calibre1">　　[super viewDidLoad];</p>

  <p class="calibre1">　　…</p>

  <p class="calibre1">　　NSDictionary *nameMap = @{ @“imageView” : self.imageView,</p>

  <p class="calibre1">　　@“dateLabel” : self.dateLabel,</p>

  <p class="calibre1">　　@“toolbar” : self.toolbar };</p>

  <p class="calibre1"><span class="calibre10">　　// imageView的左边和右边与父视图的距离都是0点</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　NSArray *horizontalConstraints =</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　[NSLayoutConstraint constraintsWithVisualFormat:</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　@“H:|-0-[imageView]-0-|”</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　options:0</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　metrics:nil</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　views:nameMap];</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　// imageView的顶边与dateLabel的距离是8点，底边与toolbar的距离也是8点</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　NSArray *verticalConstraints =</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　[NSLayoutConstraint constraintsWithVisualFormat:</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　@“V:[dateLabel]-[imageView]-[toolbar]”</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　options:0</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　metrics:nil</span><br class="calibre2"/></p>

  <p class="calibre1"><span class="calibre10">　　views:nameMap];</span><br class="calibre2"/></p>

  <p class="calibre1">　　}</p>

  <p class="calibre1"><br class="calibre2"/></p>
<div class="calibre5">本书由「<a href="https://epubw.com" class="calibre6">ePUBw.COM</a>」整理，<a href="https://epubw.com" class="calibre6">ePUBw.COM</a> 提供最新最全的优质电子书下载！！！</div></body></html>
